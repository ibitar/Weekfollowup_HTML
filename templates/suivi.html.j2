<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Suivi des actions – {{ today }}</title>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css"/>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; margin:20px; }
  h1, h2 { font-family: Arial, sans-serif; }
  .toc ul {
    display: flex; flex-wrap: wrap; gap: 8px;
    padding: 0; margin: 0 0 30px 0;
  }
  .toc li { list-style: none; }
  .toc a {
    display: block;
    padding: 6px 12px;
    background: #f2f2f2;
    border-radius: 20px;
    text-decoration: none;
    color: #0066cc;
    transition: background 0.2s;
  }
  .toc a:hover { background: #ddeeff; }
  table { table-layout: fixed; width:100%; border-collapse: collapse; margin-bottom:40px; }
  th, td { padding:6px; border:1px solid #ddd; word-wrap: break-word; }
  th { background:#e6e6e6; font-size:14px; text-align:left; }
  td { font-size:12px; text-align:left; white-space: pre-wrap; }
  .en-conge { color:#a00; font-style: italic; margin: 6px 0 16px 0; }
</style>
<script>
$(document).ready(function() {
    $('table.display').each(function() {
      $(this).DataTable({
        paging:      true,
        pageLength:  {{ page_length }},
        ordering:    true,
        order:       [[3, '{{ order_dir }}']],
        columnDefs:  [{ targets: 3, type: 'num' }],
        fixedHeader: true,
        scrollX:     true,
        language:    { url: 'https://cdn.datatables.net/plug-ins/1.13.4/i18n/fr-FR.json' }
      });
    });
});
</script>
</head>
<body>
<h1>Suivi des actions – {{ today }}</h1>

<nav class="toc">
  <ul>
  {% for nom in ingenieurs %}
    <li><a href="#{{ nom.replace(' ', '_') }}">{{ nom }}</a></li>
  {% endfor %}
  </ul>
</nav>

<p><strong>Conventions de lecture du tableau :</strong></p>
<ul>
  <li><strong>Actions “Machine”</strong> : Toute action de calcul machine dont les données sont prêtes doit être priorisée, car
il s’agit de temps machine et non de temps humain.</li>
</ul>

{% for section in sections %}
  <hr style='margin:40px 0; border:none; border-top:1px solid #ccc;'/>
  <h2 id="{{ section.id }}">Actions de {{ section.nom }}</h2>
  {% if section.conge %}
    <p class="en-conge">En congé — pas d'actions listées pour cette période.</p>
  {% elif not section.rows %}
    <p class='en-conge'>Aucune action à afficher.</p>
  {% else %}
  <table class='display'>
    <thead><tr>
      {% for col in colonnes %}
        <th>{{ col }}</th>
      {% endfor %}
    </tr></thead>
    <tbody>
      {% for row in section.rows %}
        <tr>
          {% for val in row %}
            <td>{{ val }}</td>
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>
  {% endif %}
{% endfor %}

</body>
</html>
